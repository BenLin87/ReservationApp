function ReservationTime(n){this.time=n}function Reservation(n,t){this.date=n;this.times=t}function User(n){this.name=n}function Order(n,t,i){this.user=n;this.id=t;this.reservations=i}function ModifiedReservations(n,t,i){this.id=n;this.addReservations=t;this.deleteReservations=i}function createReservations(n){var t=[],i,r;n.each(function(){var n=$(this).attr("date"),r=$(this).attr("time"),i;n in t?t[n].push(new ReservationTime(r)):(i=[],i.push(new ReservationTime(r)),t[n]=i)});i=[];for(const n in t)r=new Reservation(n,t[n]),i.push(r);return i}async function saveModifiedReservationTimes(){var n=sessionStorage.getItem("OrderData"),t;if(n!=null)try{var i=await cryptor.decrypt(n),r=$(".table_cell.selected").not(".originalTime"),u=createReservations(r),f=$(".table_cell.originalTime").not(".selected"),e=f.map(function(){return $(this).attr("Guid")}).get(),o=JSON.parse(i).id,s=new ModifiedReservations(o,u,e);const h=JSON.stringify(s);t=await cryptor.encrypt(h);sessionStorage.setItem("ModifiedReservations",t)}catch(h){alert(h)}}async function saveSelectedReservationTimes(){var s=$(".table_cell.selected"),r=createReservations(s),t,u,i,f,e,o;let n="";t=sessionStorage.getItem("OrderData");try{t!=null?(u=await cryptor.decrypt(t),i=JSON.parse(u),i.reservations=r,n=JSON.stringify(i)):(f=new User(null),e=new Order(f,null,r),n=JSON.stringify(e));o=await cryptor.encrypt(n);sessionStorage.setItem("OrderData",o)}catch(h){alert(h)}}import Cryptor from"./Cryptor.js";const cryptor=new Cryptor;$(function(){});$(document).on("click","#next_btn",async function(){var n,t;if($(".table_cell.selected").length==0){n=$("#currentCulture").text();n!=null&&(n=="zh-TW"||n=="zh-Hant")?$("#messageDialog p").text("請選擇至少一筆預約時段!"):$("#messageDialog p").text("Please select at least one reservation time!");$("#messageDialog").dialog("open");return}t=$("#nextUrl").text();await saveSelectedReservationTimes();await saveModifiedReservationTimes();location.href=t});